<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RangVigyaan - An Immersive AI Kolam Experience</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Jost:wght@300;400;500;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <style>
        :root { 
            --glow-color: #e52e71; 
            --accent-color: #ff8a00;
            --secondary-color: #8a2be2;
        }m1.jpeg
        @keyframes text-shine { to { background-position: 200% center; } }
        @keyframes fade-in-up { 0% { opacity: 0; transform: translateY(20px); } 100% { opacity: 1; transform: translateY(0); } }
        @keyframes card-cascade-in { 0% { opacity: 0; transform: scale(0.9) translateY(20px); } 100% { opacity: 1; transform: scale(1) translateY(0); } }
        @keyframes toast-in { 0% { opacity: 0; transform: translateX(100%); } 100% { opacity: 1; transform: translateX(0); } }
        
        body { font-family: 'Jost', sans-serif; background-color:rgb(0, 0, 0); color: #f0f0f0; overflow-x: hidden; cursor: none; }
        /* FIX: Restore cursor for interactive elements */
        a, button, textarea, input, [onclick] { cursor: auto; }

        #three-canvas { position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; z-index: -1; }
        .site-container { display: flex; flex-direction: column; min-height: 100vh; }
        main { flex-grow: 1; }
        .content-section { display: none; }
        .content-section.active { display: block; flex-grow: 1; animation: fade-in-up 0.6s cubic-bezier(0.25, 1, 0.5, 1); }
        #ai-kolam.content-section.active { display: flex; }

        /* Main Site Card & UI Styles */
        .glass-card { --mx: 50%; --my: 50%; background: rgba(18, 18, 18, 0.6); backdrop-filter: blur(25px); -webkit-backdrop-filter: blur(25px); border-radius: 1.5rem; position: relative; overflow: hidden; border: 1px solid rgba(255, 255, 255, 0.1); transform-style: preserve-3d; }
        .glass-card::before { content: ''; position: absolute; left: 0; top: 0; width: 100%; height: 100%; border-radius: inherit; opacity: 0; background: radial-gradient(400px circle at var(--mx) var(--my), rgba(229, 46, 113, 0.2), transparent 80%); transition: opacity 0.4s; z-index: 0; }
        .glass-card:hover::before { opacity: 1; }
        .glowing-border::after { content: ""; position: absolute; left: 0; top: 0; width: 100%; height: 100%; border-radius: inherit; background: radial-gradient(300px circle at var(--mx) var(--my), var(--glow-color), transparent 40%); z-index: -1; }
        .card-content-wrapper { position: relative; z-index: 1; transform: translateZ(20px); height: 100%; display: flex; flex-direction: column; }
        .header-title { font-weight: 700; letter-spacing: 0.1em; background: linear-gradient(to right, var(--accent-color), var(--glow-color), var(--secondary-color), var(--accent-color)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; text-shadow: 0 0 25px rgba(229, 46, 113, 0.6); background-size: 200% auto; animation: text-shine 8s linear infinite; }
        .section-header { text-align: center; margin-bottom: 2rem; }
        .section-header h2 { font-size: 3rem; font-weight: 700; margin-bottom: 1rem; }
        .section-header p { font-size: 1.125rem; color: #a0a0a0; max-width: 600px; margin: 0 auto; }
        .btn { background: linear-gradient(45deg, var(--accent-color), var(--glow-color)); color: white; padding: 0.75rem 1.5rem; border-radius: 9999px; font-weight: 500; transition: all 0.3s ease; box-shadow: 0 4px 15px rgba(229, 46, 113, 0.35); }
        .btn:hover { transform: translateY(-3px) scale(1.05); box-shadow: 0 6px 20px rgba(229, 46, 113, 0.5); }
        .cursor-dot { position: fixed; top: 0; left: 0; transform: translate(-50%, -50%); border-radius: 50%; z-index: 10000; pointer-events: none; width: 8px; height: 8px; background-color: var(--glow-color); box-shadow: 0 0 10px var(--glow-color), 0 0 20px var(--glow-color); }
        .sparkle-trail { position: fixed; border-radius: 50%; width: 8px; height: 8px; z-index: 9999; pointer-events: none; }
        nav { background: rgba(10, 10, 10, 0.5); backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px); border-bottom: 1px solid rgba(255, 255, 255, 0.1); flex-shrink: 0; }
        .nav-link, .nav-icon { position: relative; color: #e0e0e0; transition: color 0.3s; }
        .nav-link:hover, .nav-icon:hover { color: var(--glow-color); }
        .nav-link::after { content: ''; position: absolute; width: 0; height: 2px; bottom: -5px; left: 50%; background-color: var(--glow-color); transition: all 0.3s ease; }
        .nav-link:hover::after, .nav-link.active::after { width: 100%; left: 0; }
        .page-title { color: var(--accent-color); text-shadow: 0 0 10px rgba(255, 138, 0, 0.5); }
        .card-grid { display: flex; gap: 2rem; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); }
        .shop-grid {display: grid; gap: rem; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));}
        .card-item { opacity: 0; animation: card-cascade-in 0.6s cubic-bezier(0.25, 1, 0.5, 1) forwards; transition: transform 0.1s linear; }
        .card-item img { aspect-ratio: 16 / 10; object-fit: cover; }
        .product-card-img { aspect-ratio: 1 / 1 !important; border-radius: 1.5rem 1.5rem 0 0; transform: translateZ(40px); }
        .icon-btn { background: rgba(255,255,255,0.1); border-radius: 50%; padding: 0.5rem; transition: all 0.2s; }
        .icon-btn:hover { background: rgba(255,255,255,0.2); transform: scale(1.1); }
        .icon-btn.active { color: var(--glow-color); background: rgba(229, 46, 113, 0.2); }
        .nav-counter { position: absolute; top: -5px; right: -8px; background-color: var(--glow-color); color: white; border-radius: 50%; width: 20px; height: 20px; font-size: 12px; display: flex; align-items: center; justify-content: center; font-weight: bold; }
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 100; display: none; align-items: center; justify-content: center; }
        .modal-overlay.active { display: flex; }
        .modal-content { max-width: 800px; width: 90%; max-height: 80vh; overflow-y: auto; }
        #toast-container { position: fixed; bottom: 2rem; right: 2rem; z-index: 200; display: flex; flex-direction: column; gap: 1rem; }
        .toast { animation: toast-in 0.5s cubic-bezier(0.25, 1, 0.5, 1); }
        .filter-btn { background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); color: #ccc; transition: all 0.3s; }
        .filter-btn:hover { background: rgba(255,255,255,0.1); color: white; }
        .filter-btn.active { background: linear-gradient(45deg, var(--accent-color), var(--glow-color)); color: white; border-color: transparent; }

        /* --- AI KOLAM STYLES --- */
        .gemini-main { flex-grow: 1; display: flex; flex-direction: column; position: relative; }
        .gemini-chat-area { flex-grow: 1; overflow-y: auto; padding: 1rem 2rem; padding-bottom: 10rem; }
        .gemini-input-area { position: fixed; bottom: 1.5rem; left: 0; right: 0; padding: 0 1rem; z-index: 100; }
        .gemini-input-bar-wrapper { max-width: 840px; margin: 0 auto; }
        .gemini-input-bar { transition: all 0.3s ease; }
        .gemini-input-bar:focus-within { border-color: rgba(229, 46, 113, 0.7); box-shadow: 0 0 20px rgba(229, 46, 113, 0.5); }
        .gemini-input-bar textarea { flex-grow: 1; background: transparent; border: none; color: white; resize: none; min-height: 44px; padding: 0.5rem; font-size: 1rem; }
        .gemini-input-bar textarea:focus { outline: none; }
        .gemini-tool-btn { background: transparent; border: 1px solid rgba(255,255,255,0.2); color: #ddd; cursor: pointer; transition: background-color 0.2s; border-radius: 50%; width: 44px; height: 44px; display: flex; align-items: center; justify-content: center; flex-shrink: 0; }
        .gemini-tool-btn:hover { background-color: rgba(255,255,255,0.1); }
        .gemini-tool-btn.hidden { display: none; }
        .chat-message { display: flex; gap: 1rem; max-width: 1280px; margin: 1rem auto; width: 100%; }
        .ai-message { animation: fade-in-up 0.6s cubic-bezier(0.25, 1, 0.5, 1) forwards; }
        .chat-avatar { width: 40px; height: 40px; border-radius: 50%; background: linear-gradient(45deg, var(--accent-color), var(--glow-color)); display: flex; align-items: center; justify-content: center; flex-shrink: 0; box-shadow: 0 0 10px rgba(229, 46, 113, 0.5); }
        .chat-avatar i { stroke: white; }
        .user-message .chat-avatar { background: #333; box-shadow: none; }
        .user-message .chat-content { padding-top: 0.5rem; }
        .svg-container { width: 100%; aspect-ratio: 1 / 1; position: relative; z-index: 1; }
        .analysis-item { animation: fade-in-up 0.5s ease-out forwards; opacity: 0; transform: translateY(10px); }

        /* ðŸ©µ FIX: Ensure AI Kolam input is clickable and not blocked */
        #three-canvas, #kolamCanvas { pointer-events: none !important; z-index: 0 !important; }
        .gemini-input-area, .gemini-input-bar, .gemini-input-bar textarea, .gemini-tool-btn { position: relative; z-index: 200 !important; pointer-events: auto !important; }
        .gemini-main { position: relative; z-index: 100; }

    </style>
</head>
<body class="site-container">
    <div class="cursor-dot"></div>
    <canvas id="three-canvas"></canvas>

    <nav class="sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-20">
                <div class="flex-shrink-0 text-3xl font-bold header-title tracking-normal cursor-pointer" onclick="navigateTo('home')">RangVigyaan</div>
                <div class="hidden md:flex items-center space-x-4">
                    <a href="#home" class="nav-link px-2 py-2 text-sm font-medium">Home</a>
                    <a href="#ai-kolam" class="nav-link px-2 py-2 text-sm font-medium">AI Kolam</a>
                    <a href="#shop" class="nav-link px-2 py-2 text-sm font-medium">Shop</a>
                    <a href="#learn" class="nav-link px-2 py-2 text-sm font-medium">Learn</a>
                    <a href="#diy-kits" class="nav-link px-2 py-2 text-sm font-medium">DIY Kits</a>
                    <a href="#gallery-3d" class="nav-link px-2 py-2 text-sm font-medium">3D Gallery</a>
                    <a href="#gallery-mandala" class="nav-link px-2 py-2 text-sm font-medium">Mandalas</a>
                </div>
                <div class="flex items-center space-x-4">
                    <button class="nav-icon" id="wishlist-btn" title="Wishlist"><i data-lucide="heart"></i><span id="wishlist-counter" class="nav-counter hidden">0</span></button>
                    <button class="nav-icon" id="cart-btn" title="Cart"><i data-lucide="shopping-bag"></i><span id="cart-counter" class="nav-counter hidden">0</span></button>
                    <button class="nav-icon" id="orders-btn" title="My Orders"><i data-lucide="receipt"></i></button>
                </div>
            </div>
        </div>
    </nav>

    <main class="relative">
        <section id="home" class="content-section"><div class="max-w-7xl mx-auto py-16 px-4 text-center flex flex-col items-center justify-center min-h-[calc(100vh-168px)]"><h1 class="text-5xl md:text-7xl font-bold header-title">RANGVIGYAAN</h1><p class="text-lg md:text-xl mt-4 text-gray-300 tracking-wider">The AI Art Weaver</p><p class="max-w-3xl mx-auto mt-8 text-gray-400">Welcome to a digital sanctuary where ancient tradition meets artificial intelligence. Generate, learn, create, and own a piece of this beautiful fusion of art and technology.</p>
            </div></section>
        
        <section id="ai-kolam" class="content-section">
            <div class="flex-grow flex flex-col">
                <main class="gemini-main">
                    <div id="gemini-chat-area" class="gemini-chat-area">
                        <div id="chat-welcome" class="text-center text-gray-400 p-8 max-w-3xl mx-auto">
                            <h2 class="text-5xl md:text-6xl font-bold header-title mb-4">AI Kolam Weaver</h2>
                            <p class="text-lg">Describe a Rangoli, and I will bring it to life. <br> What beautiful pattern are we creating today?</p>
                        </div>
                    </div>
                    <div class="gemini-input-area">
                        <div class="gemini-input-bar-wrapper">
                            <div class="gemini-input-bar glass-card">
                                <button class="gemini-tool-btn" title="Upload Image"><i data-lucide="image"></i></button>
                                <textarea id="prompt-input" rows="1" placeholder="e.g., a symmetrical flower with eight petals"></textarea>
                                <button id="send-btn" class="gemini-tool-btn hidden" title="Send"><i data-lucide="arrow-up"></i></button>
                            </div>
                        </div>
                    </div>
                </main>
            </div>
        </section>

        <section id="shop" class="content-section">
            <div class="max-w-7xl mx-auto py-16 px-4 sm:px-6 lg:px-8">
                <div class="section-header">
                    <h2 class="header-title">Art You Can Own</h2>
                    <p>Bring the magic of RangVigyaan into your life. Explore our curated collection, all featuring unique AI-generated designs.</p>
                </div>
                <div id="filter-container" class="flex flex-wrap justify-center gap-4 mb-12">
                    <button class="filter-btn active px-6 py-2 rounded-full" data-category="all">All</button>
                    <button class="filter-btn px-6 py-2 rounded-full" data-category="dress">Dresses</button>
                    <button class="filter-btn px-6 py-2 rounded-full" data-category="bag">Bags</button>
                    <button class="filter-btn px-6 py-2 rounded-full" data-category="pillow">Pillow Covers</button>
                    <button class="filter-btn px-6 py-2 rounded-full" data-category="wall">Wall Hangings</button>
                </div>
                <div id="product-grid" class="shop-grid"></div>
            </div>
        </section>

        <section id="learn" class="content-section">
            <div class="max-w-7xl mx-auto py-16 px-4 sm:px-6 lg:px-8">
                <div class="section-header">
                    <h2 class="header-title">The Lore of Lines</h2>
                    <p>Discover the rich history, deep symbolism, and sacred geometry behind the timeless art of Kolam and Mandalas.</p>
                </div>
                <div class="space-y-12">
                     <div class="card-item glass-card glowing-border">
                        <div class="card-content-wrapper">
                           <div class="grid grid-cols-1 md:grid-cols-2 items-center gap-8 p-8">
                                <img src="ancientKolam.jpeg" alt="Ancient Art of Kolam" class="rounded-xl shadow-2xl w-full">
                                <div class="text-center md:text-left">
                                    <h3 class="text-3xl font-bold page-title mb-4">A Journey Through Time</h3>
                                    <p class="text-gray-300 mb-6">Kolam is an ancient drawing tradition from Southern India, a form of ephemeral art passed down through generations. Traditionally drawn with rice flour by women at the thresholds of homes, these intricate patterns are more than just decoration; they are a daily ritual of welcome, harmony, and a connection to the cosmos.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="card-grid">
                        <div class="card-item glass-card glowing-border">
                            <div class="card-content-wrapper p-6">
                                <h3 class="text-xl font-bold page-title mb-2">Symbolism in Patterns</h3>
                                <p class="text-gray-400">Each element in a Kolam has meaning. The lotus represents purity and creation, intertwined knots signify eternity and the cycle of life, and geometric shapes evoke cosmic order. They are visual prayers for prosperity and well-being.</p>
                            </div>
                        </div>
                         <div class="card-item glass-card glowing-border">
                            <div class="card-content-wrapper p-6">
                                <h3 class="text-xl font-bold page-title mb-2">The Sacred Geometry</h3>
                                <p class="text-gray-400">Kolam designs are a beautiful expression of mathematical principles. Built around a grid of dots, they explore concepts of symmetry, fractals, and algorithms. This mathematical precision is believed to create a field of harmonious energy.</p>
                            </div>
                        </div>
                         <div class="card-item glass-card glowing-border">
                            <div class="card-content-wrapper p-6">
                                <h3 class="text-xl font-bold page-title mb-2">From Flour to Pixels</h3>
                                <p class="text-gray-400">While traditionally made with rice flour, the art form has evolved. Today, artists and technologists explore these ancient patterns through digital art, 3D modeling, and even AI, bringing a timeless tradition into a new, futuristic dimension.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <section id="diy-kits" class="content-section">
             <div class="max-w-7xl mx-auto py-16 px-4 sm:px-6 lg:px-8">
                <div class="section-header">
                    <h2 class="header-title">Create Your Own Magic</h2>
                    <p>Unleash the artist within. Our DIY hardware kits provide a hands-on experience for children and adults to practice the timeless arts of Rangoli and Mandala making.</p>
                </div>
                <div class="card-item glass-card glowing-border">
                     <div class="card-content-wrapper">
                        <div class="grid grid-cols-1 md:grid-cols-2 items-center gap-8 p-8 md:p-12">
                            <img src="diyKit.jpeg" alt="DIY Rangoli and Mandala Kit" class="rounded-xl shadow-2xl w-full">
                            <div class="text-center md:text-left">
                                <h3 class="text-3xl font-bold page-title mb-4">The RangVigyaan Explorer Kit</h3>
                                <p class="text-gray-300 mb-6">Unleash your creativity with this vibrant DIY Rangoli kit! ðŸŽ¨
                                    A perfect blend of art and mindfulness, it helps you relax while crafting beauty.
                                    Boost focus, express yourself, and add a handmade sparkle to your space.
                                    Create, unwind, and let your imagination bloom! ðŸŒ¸âœ¨
                                    </p>
                                <!-- <button class="btn mt-8 !text-lg !py-3 !px-6">Explore All Kits</button> -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <section id="gallery-3d" class="content-section">
            <div class="max-w-7xl mx-auto py-16 px-4 sm:px-6 lg:px-8">
                <div class="section-header">
                    <h2 class="header-title">Dimensions of Design</h2>
                    <p>Explore the mesmerizing depth and form of Kolam and Rangoli in three dimensions. A fusion of tradition and futuristic 3D artistry, rendered to perfection.</p>
                </div>
                <div class="card-grid">
                    <div class="card-item glass-card glowing-border"><div class="card-content-wrapper"><img src="31.jpeg" alt="3D Render of a spiral Kolam"><div class="p-4"><h3 class="text-lg font-bold text-center page-title">Crystalline Spiral</h3></div></div></div>
                    <div class="card-item glass-card glowing-border"><div class="card-content-wrapper"><img src="32.jpeg" alt="3D Render of a floral Rangoli"><div class="p-4"><h3 class="text-lg font-bold text-center page-title">Neon Bloom</h3></div></div></div>
                    <div class="card-item glass-card glowing-border"><div class="card-content-wrapper"><img src="33.jpeg" alt="3D Render of a metallic pattern"><div class="p-4"><h3 class="text-lg font-bold text-center page-title">Metalic Weave</h3></div></div></div>
                    <div class="card-item glass-card glowing-border"><div class="card-content-wrapper"><img src="34.jpeg" alt="3D Render of a metallic pattern"><div class="p-4"><h3 class="text-lg font-bold text-center page-title">Chromatic Lotus</h3></div></div></div>
                    

                </div>
            </div>
        </section>
        <section id="gallery-mandala" class="content-section">
             <div class="max-w-7xl mx-auto py-16 px-4 sm:px-6 lg:px-8">
                <div class="section-header">
                    <h2 class="header-title">Universe in a Circle</h2>
                    <p>Lose yourself in the infinite complexity of Mandalas. Each design is a journey to the center of the self, generated by AI to inspire meditation and awe.</p>
                </div>
                <div class="card-grid">
                    <div class="card-item glass-card glowing-border"><div class="card-content-wrapper"><img src="m1.jpeg" alt="Intricate black and white Mandala"><div class="p-4"><h3 class="text-lg font-bold text-center page-title">â‚¹199 Peacock's Grace</h3></div></div></div>
                    <div class="card-item glass-card glowing-border"><div class="card-content-wrapper"><img src="m2.jpeg" alt="Colorful vibrant Mandala"><div class="p-4"><h3 class="text-lg font-bold text-center page-title">â‚¹199 Galactic Center</h3></div></div></div>
                    <div class="card-item glass-card glowing-border"><div class="card-content-wrapper"><img src="m3.jpeg" alt="Detailed dot-art Mandala"><div class="p-4"><h3 class="text-lg font-bold text-center page-title">â‚¹199 Stippled Sun</h3></div></div></div>
                </div>
            </div>
        </section>

    </main>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        
        // --- GLOBAL SETUP & E-COMMERCE APP ---
        const App = {
            products: [
                { id: 1, name: 'Nebula Flow Dress', category: 'dress', price: 799, image: 'img1.jpeg' },
                { id: 2, name: 'Geometric Sun Dress', category: 'dress', price: 599, image: 'img2.jpeg' },
                { id: 3, name: 'Mandala Maxi Dress', category: 'dress', price: 549, image: 'img3.jpeg' },
                { id: 4, name: 'Symmetric Shift Dress', category: 'dress', price: 499, image: 'img4.jpeg' },
                { id: 5, name: 'Cosmic Tote Bag', category: 'bag', price: 299, image: 'img5.jpeg' },
                { id: 6, name: 'Lotus Crossbody Bag', category: 'bag', price: 279, image: 'img6.jpeg' },
                { id: 7, name: 'Patterned Backpack', category: 'bag', price: 299, image: 'img7.jpeg' },
                { id: 8, name: 'Embroidered Pouch', category: 'bag', price: 249, image: 'img8.jpeg' },
                { id: 9, name: 'Serenity Pillow Cover', category: 'pillow', price: 249, image: 'img9.jpeg' },
                { id: 10, name: 'Vibrant Mandala Cushion', category: 'pillow', price: 249, image: 'img10.jpeg' },
                { id: 11, name: 'Geometric Accent Pillow', category: 'pillow', price: 249, image: 'img11.jpeg' },
                { id: 12, name: 'Kolam Line Art Pillow', category: 'pillow', price: 249, image: 'img12.jpeg' },
                { id: 13, name: 'Galaxy Mandala Tapestry', category: 'wall', price: 349, image: 'img13.jpeg' },
                { id: 14, name: 'Sun & Moon Wall Art', category: 'wall', price: 299, image: 'img14.jpeg' },
                { id: 15, name: 'Seven Chakras Hanging', category: 'wall', price: 299, image: 'img15.jpeg' },
                { id: 16, name: 'Digital Bloom Canvas', category: 'wall', price: 299, image: 'img16.jpeg' },
            ],
            state: { cart: [], wishlist: [], orders: [], activeFilter: 'all' },
            init() { this.loadState(); this.renderProducts(); this.updateCounters(); this.attachEventListeners(); },
            loadState() { const c=localStorage.getItem('rangVigyaan_cart'),w=localStorage.getItem('rangVigyaan_wishlist'),o=localStorage.getItem('rangVigyaan_orders'); if(c)this.state.cart=JSON.parse(c); if(w)this.state.wishlist=JSON.parse(w); if(o)this.state.orders=JSON.parse(o); },
            saveState() { localStorage.setItem('rangVigyaan_cart', JSON.stringify(this.state.cart)); localStorage.setItem('rangVigyaan_wishlist', JSON.stringify(this.state.wishlist)); localStorage.setItem('rangVigyaan_orders', JSON.stringify(this.state.orders)); },
            renderProducts() { const grid=document.getElementById('product-grid'),filtered=this.state.activeFilter==='all'?this.products:this.products.filter(p=>p.category===this.state.activeFilter); grid.innerHTML=filtered.map(p=>{const inWish=this.state.wishlist.includes(p.id),inCart=this.state.cart.some(i=>i.id===p.id);return `
                <div class="card-item glass-card glowing-border" style="animation-delay: ${filtered.indexOf(p)*50}ms">
                    <div class="card-content-wrapper">
                        <img src="${p.image}" alt="${p.name}" class="product-card-img">
                        <div class="p-6 flex-grow flex flex-col">
                            <h3 class="text-xl font-bold page-title">${p.name}</h3>
                            <div class="mt-4 flex-grow flex justify-between items-center">
                                <span class="text-2xl font-bold text-white">â‚¹${p.price}</span>
                                <div class="flex items-center gap-2">
                                    <button class="icon-btn wishlist-toggle-btn ${inWish?'active':''}" data-id="${p.id}" title="Wishlist"><i data-lucide="heart"></i></button>
                                    <button class="btn !px-4 !py-2 add-to-cart-btn" data-id="${p.id}">${inCart?'In Cart':'Add'}</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>`}).join(''); this.applyMesmerizingEffects(); lucide.createIcons(); },
            updateCounters() { const c=this.state.cart.reduce((s,i)=>s+i.quantity,0),w=this.state.wishlist.length,cc=document.getElementById('cart-counter'),wc=document.getElementById('wishlist-counter'); cc.textContent=c; cc.classList.toggle('hidden',c===0); wc.textContent=w; wc.classList.toggle('hidden',w===0); },
            attachEventListeners() { const pg=document.getElementById('product-grid'); pg.addEventListener('click',e=>{const acb=e.target.closest('.add-to-cart-btn'),wtb=e.target.closest('.wishlist-toggle-btn'); if(acb)this.addToCart(parseInt(acb.dataset.id)); if(wtb)this.toggleWishlist(parseInt(wtb.dataset.id));}); document.getElementById('filter-container').addEventListener('click',e=>{if(e.target.matches('.filter-btn')){document.querySelector('.filter-btn.active').classList.remove('active');e.target.classList.add('active');this.state.activeFilter=e.target.dataset.category;this.renderProducts();}}); },
            addToCart(id) { const i=this.state.cart.find(item=>item.id===id); if(i)i.quantity++; else this.state.cart.push({id,quantity:1}); this.saveState(); this.updateCounters(); this.renderProducts(); },
            toggleWishlist(id) { const i=this.state.wishlist.indexOf(id); if(i>-1)this.state.wishlist.splice(i,1); else this.state.wishlist.push(id); this.saveState(); this.updateCounters(); this.renderProducts(); },
            applyMesmerizingEffects() { document.querySelectorAll(".card-item, .glass-card.interactive-card").forEach(c=>{c.addEventListener("mousemove",e=>{const r=c.getBoundingClientRect(),x=e.clientX-r.left,y=e.clientY-r.top,rx=(y-r.height/2)/(r.height/2)*-8,ry=(x-r.width/2)/(r.width/2)*8;c.style.setProperty("--mx",`${x}px`);c.style.setProperty("--my",`${y}px`);c.style.transform=`perspective(1000px) rotateX(${rx}deg) rotateY(${ry}deg) scale3d(1.05,1.05,1.05)`;});c.addEventListener("mouseleave",()=>{c.style.transition='transform 0.6s cubic-bezier(0.23,1,0.32,1)';c.style.transform='perspective(1000px) rotateX(0) rotateY(0) scale3d(1,1,1)';});c.addEventListener('mouseenter',()=>c.style.transition='transform 0.1s linear');}); }
        };
        App.init();

        // --- BACKGROUND, CURSOR & NAVIGATION ---
        const VIBRANT_COLORS = ['#ff8a00', '#e52e71', '#8a2be2', '#00bfff', '#32cd32'];
        window.addEventListener('mousemove', e => { document.querySelector('.cursor-dot').style.transform = `translate(${e.clientX}px, ${e.clientY}px) translate(-50%, -50%)`; if(Math.random()>0.5){const s=document.createElement('div');s.className='sparkle-trail';s.style.left=`${e.clientX}px`;s.style.top=`${e.clientY}px`;s.style.backgroundColor=VIBRANT_COLORS[Math.floor(Math.random()*VIBRANT_COLORS.length)];document.body.appendChild(s);s.animate([{opacity:1,transform:'scale(1)'},{opacity:0,transform:`scale(0) translate(${(Math.random()-0.5)*50}px, ${(Math.random()-0.5)*50}px)`}],1000);setTimeout(()=>s.remove(),1000);} });
        const scene=new THREE.Scene(),camera=new THREE.PerspectiveCamera(75,window.innerWidth/window.innerHeight,0.1,1000),renderer=new THREE.WebGLRenderer({canvas:document.getElementById('three-canvas'),alpha:true});renderer.setSize(window.innerWidth,window.innerHeight);const pC=5000,pos=new Float32Array(pC*3),cls=new Float32Array(pC*3),bC=[new THREE.Color('#ff8a00'),new THREE.Color('#e52e71'),new THREE.Color('#8a2be2')];for(let i=0;i<pC;i++){pos[i*3]=(Math.random()-0.5)*15;pos[i*3+1]=(Math.random()-0.5)*15;pos[i*3+2]=(Math.random()-0.5)*15;const c=bC[i%bC.length];cls[i*3]=c.r;cls[i*3+1]=c.g;cls[i*3+2]=c.b;}const parts=new THREE.BufferGeometry();parts.setAttribute('position',new THREE.BufferAttribute(pos,3));parts.setAttribute('color',new THREE.BufferAttribute(cls,3));const pSys=new THREE.Points(parts,new THREE.PointsMaterial({size:0.02,vertexColors:true,transparent:true,opacity:0.8,blending:THREE.AdditiveBlending}));scene.add(pSys);camera.position.z=5;const clock=new THREE.Clock(),mouse=new THREE.Vector2();window.addEventListener('mousemove',e=>{mouse.x=(e.clientX/window.innerWidth)*2-1;mouse.y=-(e.clientY/window.innerHeight)*2+1;});function animateThree(){requestAnimationFrame(animateThree);const eT=clock.getElapsedTime();pSys.rotation.y=eT*0.05;camera.position.x+=(mouse.x*0.8-camera.position.x)*0.04;camera.position.y+=(mouse.y*0.8-camera.position.y)*0.04;camera.lookAt(scene.position);renderer.render(scene,camera);}animateThree();
        window.navigateTo=function(id){document.querySelectorAll('.content-section').forEach(s=>s.classList.remove('active'));const ts=document.getElementById(id);if(ts)ts.classList.add('active');document.querySelectorAll('.nav-link').forEach(l=>l.classList.toggle('active',l.getAttribute('href').substring(1)===id));};document.querySelectorAll('.nav-link').forEach(l=>l.addEventListener('click',e=>{e.preventDefault();navigateTo(e.target.getAttribute('href').substring(1));}));

        // --- AI KOLAM SCRIPT ---
        let isDrawing = false;
        const aiDesignLibrary = {
            'default': {
                descriptiveText: "An excellent choice. Here is a beautiful, perfectly symmetrical flower design with eight petals. Watch as ancient art and modern tech weave together to create it.",
                drawingCommands: [ ...Array(8).fill(0).map((_, i) => { const angle = (i/8)*2*Math.PI; const x = 250+120*Math.cos(angle); const y = 250+120*Math.sin(angle); return { path: `M ${x-3} ${y} A 3 3 0 1 1 ${x+3} ${y} A 3 3 0 1 1 ${x-3} ${y}`, color: 'white', fill: 'white' }; }), { path: "M 220 250 A 30 30 0 1 1 280 250 A 30 30 0 1 1 220 250", color: "#8a2be2"}, ...Array(8).fill(0).map((_, i) => { return { path: "M 250 250 Q 180 150, 250 50 Q 320 150, 250 250 Z", color: i % 2 === 0 ? "#ff8a00" : "#e52e71", transform: `rotate(${i * 45}, 250, 250)` }; }) ],
                historicContext: "Floral motifs are universal symbols of life, beauty, and purity, found in decorative traditions worldwide, from ancient Egyptian lotuses to Indian Rangoli.",
                mathAndScience: "The flower is constructed using <strong>Polar Coordinates</strong>. Each petal's position is defined by an angle and a distance from the center, a core concept in geometry."
            },
        }; 
        const promptInput = document.getElementById('prompt-input');
        const sendBtn = document.getElementById('send-btn');
        const chatArea = document.getElementById('gemini-chat-area');
        promptInput.addEventListener('input', () => sendBtn.classList.toggle('hidden', promptInput.value.trim().length === 0));
        sendBtn.addEventListener('click', handlePrompt);
        promptInput.addEventListener('keydown', e => { if (e.key === 'Enter' && !e.shiftKey) { e.preventDefault(); handlePrompt(); } });

        function handlePrompt() {
            const promptText = promptInput.value.trim();
            if (isDrawing || promptText === '') return;
            document.getElementById('chat-welcome')?.remove();
            isDrawing = true;
            promptInput.value = '';
            addMessageToChat(promptText, 'user');
            const thinkingMessage = addMessageToChat('...', 'ai', true);
            setTimeout(() => {
                const aiResponse = aiDesignLibrary['default'];
                thinkingMessage.remove();
                addMessageWithKolam(aiResponse);
                isDrawing = false;
                sendBtn.classList.add('hidden');
            }, 1500);
        }

        function addMessageToChat(content, role, isThinking = false) {
            const msg = document.createElement('div');
            msg.className = `chat-message ${role}-message`;
            const icon = role === 'user' ? 'pen-square' : 'palette';
            const thinkingHTML = `<div class="flex gap-2 items-center"><div class="w-2 h-2 bg-white rounded-full animate-pulse"></div><div class="w-2 h-2 bg-white rounded-full animate-pulse [animation-delay:0.2s]"></div><div class="w-2 h-2 bg-white rounded-full animate-pulse [animation-delay:0.4s]"></div></div>`;
            const contentHTML = isThinking ? thinkingHTML : `<p>${content}</p>`;
            msg.innerHTML = `<div class="chat-avatar"><i data-lucide="${icon}"></i></div><div class="chat-content w-full">${contentHTML}</div>`;
            chatArea.appendChild(msg);
            lucide.createIcons({ nodes: [msg] });
            chatArea.scrollTop = chatArea.scrollHeight;
            return msg;
        }

        function addMessageWithKolam(response) {
            const msg = document.createElement('div');
            msg.className = 'chat-message ai-message';
            msg.innerHTML = `
                <div class="chat-avatar"><i data-lucide="palette"></i></div>
                <div class="chat-content w-full">
                    <p class="mb-4 text-gray-300">${response.descriptiveText}</p>
                    <div class="flex flex-col gap-6 items-center">
                        <div class="w-full max-w-lg flex flex-col gap-6">
                            <div class="svg-container glass-card glowing-border p-2 sm:p-4 card-item">
                                <div class="card-content-wrapper"></div>
                            </div>
                            <div class="glass-card glowing-border p-6 card-item">
                                </div>
                        </div>
                    </div>
                </div>`;
            chatArea.appendChild(msg);
            lucide.createIcons({ nodes: [msg] });
            animateSVGPaths(msg.querySelector('.svg-container .card-content-wrapper'), response.drawingCommands);
            App.applyMesmerizingEffects(); // Apply effects to new cards
            chatArea.scrollTop = chatArea.scrollHeight;
        }

        async function animateSVGPaths(container, commands) {
            container.innerHTML = '';
            const svgNS = "http://www.w3.org/2000/svg";
            const svg = document.createElementNS(svgNS, 'svg');
            svg.setAttribute('viewBox', '0 0 500 500');
            svg.style.position = 'absolute'; svg.style.width = '100%'; svg.style.height = '100%';
            container.appendChild(svg);
            const dots = commands.filter(c=>c.fill==='white'), lines=commands.filter(c=>c.fill!=='white');
            for(const c of dots){const p=document.createElementNS(svgNS,'path');p.setAttribute('d',c.path);p.setAttribute('fill',c.fill);p.setAttribute('stroke',c.color);p.style.transformOrigin='center';p.style.transform='scale(0)';p.style.transition='transform 0.2s ease-out';svg.appendChild(p);await new Promise(r=>setTimeout(r,25));p.style.transform='scale(1)';await new Promise(r=>setTimeout(r,50));}
            await new Promise(r=>setTimeout(r,800));
            for(const c of lines){const p=document.createElementNS(svgNS,'path');p.setAttribute('d',c.path);p.setAttribute('fill','none');p.setAttribute('stroke',c.color);p.setAttribute('stroke-width','4');p.setAttribute('stroke-linecap','round');if(c.transform)p.setAttribute('transform',c.transform);svg.appendChild(p);const len=p.getTotalLength();if(len>0){p.style.strokeDasharray=len;p.style.strokeDashoffset=len;await new Promise(res=>{p.getBoundingClientRect();const dur=len/400;p.style.transition=`stroke-dashoffset ${dur}s ease-in-out`;p.style.strokeDashoffset='0';setTimeout(res,dur*1000);});}}
        }

        // Initial setup
        navigateTo('home');
        lucide.createIcons();
    });

        /*  clickEventHandle */
  // Wait for the DOM to load
  document.addEventListener("DOMContentLoaded", function () {
    // Select all card items
    const cards = document.querySelectorAll(".card-item");

    // Add click event listener to each card
    cards.forEach(card => {
      card.addEventListener("click", () => {
        window.location.href = "https://rangvigyaan.netlify.app";
      });
    });
  });


    </script>
</body>
</html>
